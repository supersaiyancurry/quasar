{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\jyesupriya\\\\Desktop\\\\quasar-frontend-3\\\\quasar-frontend\\\\src\\\\components\\\\navbar\\\\NavBar.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport UserProfile from '../user profile/UserProfile';\nimport { useAppContext } from '../utils/Context';\nimport { QUASAR_API } from '../Constants';\nimport './NavBar.css';\nimport Button from '../button/Button';\nimport cart from './cart.png'; // wrapper for the navigation bar, the comments contained in the first section are\n// relevent throughout the component\n\nconst NavBar = () => {\n  _s();\n\n  const {\n    isLoggedIn,\n    setIsLoggedIn,\n    userEmail,\n    setUserEmail,\n    userObject,\n    setUserObject,\n    crt,\n    setCrt\n  } = useAppContext();\n  const sessionKey = 'user';\n  const history = useHistory(); // const [user, setUser] = useState(sessionStorage.getItem('user'));\n\n  const [demographics, setDemographics] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [types, setTypes] = useState([]);\n  const [showUserProfile, setShowUserProfile] = useState(false);\n  const [error, setError] = useState(false);\n  /**\r\n   * Fetches the user's data if logged in and it is needed\r\n   */\n\n  const fetchUserData = async () => {\n    if (userObject || !isLoggedIn) {\n      return;\n    }\n\n    await fetch(`${QUASAR_API}/customers?email=${userEmail}`, {\n      method: 'GET',\n      headers: new Headers({\n        token: sessionStorage.getItem('token')\n      })\n    }).then(async response => {\n      if (response.ok) {\n        const userData = await response.json();\n        setUserObject(userData);\n        setCrt(userData.shoppingCart.length);\n        console.log(userData.shoppingCart.length);\n        sessionStorage.setItem('id', userData.id);\n        sessionStorage.setItem('user', userData.email);\n      }\n    });\n  };\n\n  const fetchUserDataCallback = useCallback(fetchUserData, [setUserObject, userEmail, userObject, isLoggedIn, setCrt]);\n  useEffect(fetchUserDataCallback, [fetchUserDataCallback]);\n  useEffect(() => {\n    const getDistinctValues = async () => {\n      try {\n        const demographicsReq = await fetch(`${QUASAR_API}/products/distinctValue/demographics`, {\n          headers: new Headers({\n            'Content-Type': 'application/json'\n          })\n        });\n        const demographicsData = await demographicsReq.json();\n        setDemographics(demographicsData);\n        const categoriesReq = await fetch(`${QUASAR_API}/products/distinctValue/categories`, {\n          headers: new Headers({\n            'Content-Type': 'application/json'\n          })\n        });\n        const categoriesData = await categoriesReq.json();\n        setCategories(categoriesData);\n        const typesReq = await fetch(`${QUASAR_API}/products/distinctValue/types`, {\n          headers: new Headers({\n            'Content-Type': 'application/json'\n          })\n        });\n        const typesData = await typesReq.json();\n        setTypes(typesData);\n      } catch (err) {\n        setError(true);\n      }\n    };\n\n    getDistinctValues();\n  }, []);\n  /**\r\n   * @name logOut\r\n   * @description logs a user out of the website and returns them to the homepage\r\n   */\n\n  const logOut = () => {\n    sessionStorage.removeItem(sessionKey);\n    sessionStorage.removeItem('token');\n    sessionStorage.removeItem('id');\n    setIsLoggedIn(sessionStorage.getItem(sessionKey));\n    setUserEmail(sessionStorage.getItem(sessionKey));\n    setUserObject();\n    history.push('/');\n  };\n\n  let count;\n\n  if (crt === 0) {\n    count = /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 14\n    }, this);\n  } else {\n    count = /*#__PURE__*/_jsxDEV(\"p\", {\n      children: crt\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 14\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"stickywrapper\",\n    children: [showUserProfile && /*#__PURE__*/_jsxDEV(UserProfile, {\n      user: userObject,\n      toggleCallback: setShowUserProfile\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 27\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"nottransparent\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"navbartop\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"logocontainer\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"logo\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: \"/sportsapp.png\",\n                alt: \"logo\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 114,\n                columnNumber: 28\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cartBadge\",\n          children: count\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"login\",\n          children: isLoggedIn ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"useremail mb-2\",\n              onClick: () => setShowUserProfile(true),\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-cog emailspan\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 124,\n                  columnNumber: 23\n                }, this), ' ', userEmail]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 123,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              id: \"logout\",\n              text: \"Logout\",\n              className: \"button\",\n              onClick: logOut\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(Link, {\n                to: \"/cart\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  className: \"cart-image-in\",\n                  src: cart,\n                  alt: \"...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 131,\n                  columnNumber: 38\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 131,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"useremail\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              id: \"login\",\n              text: \"Login\",\n              className: \"button\",\n              onClick: () => history.push('/login')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"cart-button\",\n              type: \"button\",\n              onClick: () => history.push('/login'),\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                className: \"cart-image-out\",\n                src: cart,\n                alt: \"...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 104\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"nav\", {\n        className: \"navbar navbar-expand-lg menu\",\n        children: error ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"navError\",\n          children: \"Nav links could not be rendered\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 20\n        }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"nav navbarnav\",\n          \"data-testid\": \"dropdown\",\n          children: Array.isArray(demographics) && demographics.map(demographic => /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"nav-item\",\n            \"data-testid\": `${demographic.toLowerCase()}`,\n            children: [/*#__PURE__*/_jsxDEV(Link, {\n              to: `/products/${demographic.toLowerCase()}`,\n              className: \"navlink\",\n              children: demographic\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              \"data-testid\": \"categories\",\n              children: categories.map(category => /*#__PURE__*/_jsxDEV(\"li\", {\n                children: [/*#__PURE__*/_jsxDEV(Link, {\n                  to: `/products/${demographic.toLowerCase()}/${category.toLowerCase()}`,\n                  children: category\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 154,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                  children: types.map(type => /*#__PURE__*/_jsxDEV(\"li\", {\n                    children: /*#__PURE__*/_jsxDEV(Link, {\n                      to: `/products/${demographic.toLowerCase()}/${category.toLowerCase()}/${type.toLowerCase()}`,\n                      children: type\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 156,\n                      columnNumber: 52\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 156,\n                    columnNumber: 48\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 155,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 5\n  }, this);\n};\n\n_s(NavBar, \"aBCydVwcju9rT/sVnkrS8NIRsxw=\", false, function () {\n  return [useAppContext, useHistory];\n});\n\n_c = NavBar;\nexport default NavBar;\n\nvar _c;\n\n$RefreshReg$(_c, \"NavBar\");","map":{"version":3,"sources":["C:/Users/jyesupriya/Desktop/quasar-frontend-3/quasar-frontend/src/components/navbar/NavBar.js"],"names":["React","useState","useEffect","useCallback","Link","useHistory","UserProfile","useAppContext","QUASAR_API","Button","cart","NavBar","isLoggedIn","setIsLoggedIn","userEmail","setUserEmail","userObject","setUserObject","crt","setCrt","sessionKey","history","demographics","setDemographics","categories","setCategories","types","setTypes","showUserProfile","setShowUserProfile","error","setError","fetchUserData","fetch","method","headers","Headers","token","sessionStorage","getItem","then","response","ok","userData","json","shoppingCart","length","console","log","setItem","id","email","fetchUserDataCallback","getDistinctValues","demographicsReq","demographicsData","categoriesReq","categoriesData","typesReq","typesData","err","logOut","removeItem","push","count","Array","isArray","map","demographic","toLowerCase","category","type"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { Link, useHistory } from 'react-router-dom';\r\nimport UserProfile from '../user profile/UserProfile';\r\nimport { useAppContext } from '../utils/Context';\r\nimport { QUASAR_API } from '../Constants';\r\nimport './NavBar.css';\r\nimport Button from '../button/Button';\r\nimport cart from './cart.png';\r\n\r\n// wrapper for the navigation bar, the comments contained in the first section are\r\n// relevent throughout the component\r\nconst NavBar = () => {\r\n  const {\r\n    isLoggedIn, setIsLoggedIn, userEmail, setUserEmail, userObject, setUserObject, crt, setCrt\r\n  } = useAppContext();\r\n  const sessionKey = 'user';\r\n  const history = useHistory();\r\n  // const [user, setUser] = useState(sessionStorage.getItem('user'));\r\n  const [demographics, setDemographics] = useState([]);\r\n  const [categories, setCategories] = useState([]);\r\n  const [types, setTypes] = useState([]);\r\n  const [showUserProfile, setShowUserProfile] = useState(false);\r\n  const [error, setError] = useState(false);\r\n\r\n  /**\r\n   * Fetches the user's data if logged in and it is needed\r\n   */\r\n  const fetchUserData = async () => {\r\n    if (userObject || !isLoggedIn) {\r\n      return;\r\n    }\r\n    await fetch(`${QUASAR_API}/customers?email=${userEmail}`, {\r\n      method: 'GET',\r\n      headers: new Headers({\r\n        token: sessionStorage.getItem('token')\r\n      })\r\n    }).then(async (response) => {\r\n      if (response.ok) {\r\n        const userData = await response.json();\r\n        setUserObject(userData);\r\n        setCrt(userData.shoppingCart.length);\r\n        console.log(userData.shoppingCart.length);\r\n        sessionStorage.setItem('id', userData.id);\r\n        sessionStorage.setItem('user', userData.email);\r\n      }\r\n    });\r\n  };\r\n\r\n  const fetchUserDataCallback = useCallback(fetchUserData,\r\n    [setUserObject, userEmail, userObject, isLoggedIn, setCrt]);\r\n  useEffect(fetchUserDataCallback, [fetchUserDataCallback]);\r\n\r\n  useEffect(() => {\r\n    const getDistinctValues = async () => {\r\n      try {\r\n        const demographicsReq = await fetch(`${QUASAR_API}/products/distinctValue/demographics`, {\r\n          headers: new Headers({\r\n            'Content-Type': 'application/json'\r\n          })\r\n        });\r\n        const demographicsData = await demographicsReq.json();\r\n        setDemographics(demographicsData);\r\n\r\n        const categoriesReq = await fetch(`${QUASAR_API}/products/distinctValue/categories`, {\r\n          headers: new Headers({\r\n            'Content-Type': 'application/json'\r\n          })\r\n        });\r\n        const categoriesData = await categoriesReq.json();\r\n        setCategories(categoriesData);\r\n\r\n        const typesReq = await fetch(`${QUASAR_API}/products/distinctValue/types`, {\r\n          headers: new Headers({\r\n            'Content-Type': 'application/json'\r\n          })\r\n        });\r\n        const typesData = await typesReq.json();\r\n        setTypes(typesData);\r\n      } catch (err) {\r\n        setError(true);\r\n      }\r\n    };\r\n    getDistinctValues();\r\n  }, []);\r\n\r\n  /**\r\n   * @name logOut\r\n   * @description logs a user out of the website and returns them to the homepage\r\n   */\r\n  const logOut = () => {\r\n    sessionStorage.removeItem(sessionKey);\r\n    sessionStorage.removeItem('token');\r\n    sessionStorage.removeItem('id');\r\n    setIsLoggedIn(sessionStorage.getItem(sessionKey));\r\n    setUserEmail(sessionStorage.getItem(sessionKey));\r\n    setUserObject();\r\n    history.push('/');\r\n  };\r\n\r\n  let count;\r\n  if (crt === 0) {\r\n    count = (<p />);\r\n  } else {\r\n    count = (<p>{crt}</p>);\r\n  }\r\n\r\n  return (\r\n    <div className=\"stickywrapper\">\r\n      {showUserProfile && <UserProfile user={userObject} toggleCallback={setShowUserProfile} />}\r\n      <div className=\"nottransparent\">\r\n        <div className=\"navbartop\">\r\n          <div className=\"logocontainer\">\r\n            <div className=\"logo\">\r\n              <Link to=\"/\"><img src=\"/sportsapp.png\" alt=\"logo\" /></Link>\r\n            </div>\r\n          </div>\r\n          <div className=\"cartBadge\">{count}</div>\r\n          <div className=\"login\">\r\n            {isLoggedIn\r\n              ? (\r\n                <div>\r\n                  <button type=\"button\" className=\"useremail mb-2\" onClick={() => setShowUserProfile(true)}>\r\n                    <span>\r\n                      <i className=\"fas fa-cog emailspan\" />\r\n                      {' '}\r\n                      {userEmail}\r\n                    </span>\r\n                  </button>\r\n                  <Button id=\"logout\" text=\"Logout\" className=\"button\" onClick={logOut} />\r\n                  <div>\r\n                    <Link to=\"/cart\"><img className=\"cart-image-in\" src={cart} alt=\"...\" /></Link>\r\n                  </div>\r\n                </div>\r\n              )\r\n              : (\r\n                <div>\r\n                  <div className=\"useremail\" />\r\n                  <Button id=\"login\" text=\"Login\" className=\"button\" onClick={() => history.push('/login')} />\r\n                  <button className=\"cart-button\" type=\"button\" onClick={() => history.push('/login')}><img className=\"cart-image-out\" src={cart} alt=\"...\" /></button>\r\n                </div>\r\n              )}\r\n          </div>\r\n        </div>\r\n        {/* the navigation bar wrapper, solely contains the navigation bar and it's links */}\r\n        <nav className=\"navbar navbar-expand-lg menu\">\r\n          {error ? <div className=\"navError\">Nav links could not be rendered</div> : (\r\n            <ul className=\"nav navbarnav\" data-testid=\"dropdown\">\r\n              {Array.isArray(demographics) && demographics.map((demographic) => (\r\n                <li className=\"nav-item\" data-testid={`${demographic.toLowerCase()}`}>\r\n                  <Link to={`/products/${demographic.toLowerCase()}`} className=\"navlink\">{demographic}</Link>\r\n                  <ul data-testid=\"categories\">\r\n                    {categories.map((category) => (\r\n                      <li>\r\n                        <Link to={`/products/${demographic.toLowerCase()}/${category.toLowerCase()}`}>{category}</Link>\r\n                        <ul>\r\n                          {types.map((type) => <li><Link to={`/products/${demographic.toLowerCase()}/${category.toLowerCase()}/${type.toLowerCase()}`}>{type}</Link></li>)}\r\n                        </ul>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          )}\r\n        </nav>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NavBar;\r\n"]},"metadata":{},"sourceType":"module"}